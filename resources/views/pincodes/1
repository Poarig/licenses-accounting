<!-- Модальное окно подтверждения удаления -->
<div class="modal fade" id="deletePincodeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Подтверждение удаления</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Вы уверены, что хотите удалить пинкод <strong id="deletePincodeName"></strong>?</p>
                <p class="text-muted">Пинкод будет помечена как удаленная и не будет отображаться в основном списке.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                <button type="button" class="btn btn-danger" id="confirmPincodeDelete">Удалить</button>
            </div>
        </div>
    </div>
</div>

    let currentPincodeId = null;

    // Подтверждение удаления пинкода
    $(document).on('click', '.delete-pincode', function() {
        currentPincodeId = $(this).data('id');
        const pincodeName = $(this).data('name');
        $('#deletePincodeName').text(pincodeName);
        $('#deletePincodeModal').modal('show');
    });

    $('#confirmPincodeDelete').click(function() {
        if (currentPincodeId) {
            $.ajax({
                url: `/pincodes/${currentPincodeId}`,
                method: 'DELETE',
                data: {
                    _token: '{{ csrf_token() }}'
                },
                success: function(response) {
                    if (response.success) {
                        $('#deletePincodeModal').modal('hide');
                        showNotification(response.message, 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    }
                },
                error: function(xhr) {
                    const error = xhr.responseJSON?.message || 'Произошла ошибка при удалении';
                    showNotification(error, 'error');
                }
            });
        }
    });

    // Восстановление пинкода
    $(document).on('click', '.restore-pincode', function() {
        const pincodeId = $(this).data('id');
        
        if (confirm('Вы уверены, что хотите восстановить этот пинкод?')) {
            $.ajax({
                url: `/pincodes/${pincodeId}/restore`,
                method: 'POST',
                data: {
                    _token: '{{ csrf_token() }}'
                },
                success: function(response) {
                    if (response.success) {
                        showNotification(response.message, 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    }
                },
                error: function(xhr) {
                    showNotification('Произошла ошибка при восстановлении', 'error');
                }
            });
        }
    });